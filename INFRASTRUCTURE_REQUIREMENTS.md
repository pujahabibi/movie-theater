# Infrastructure Requirements & Missing Components

## Overview

This document outlines the complete infrastructure requirements for the Movie Theater application and identifies all missing components that prevent the application from running successfully.

## Required Infrastructure Components

### 1. Container Runtime Environment

#### Docker Engine
- **Status**: ❌ **MISSING - CRITICAL**
- **Required Version**: Docker Engine 20.10+ or Docker Desktop
- **Current Status**: Not installed (`docker: command not found`)
- **Purpose**: Container runtime for MySQL database, backend API, and frontend services
- **Installation Required**: Yes - Critical for application startup

#### Docker Compose
- **Status**: ❌ **MISSING - CRITICAL** 
- **Required Version**: Docker Compose v2.0+
- **Current Status**: Not available (`docker-compose: command not found`)
- **Purpose**: Multi-container orchestration as defined in `docker-compose.yml`
- **Installation Required**: Yes - Critical for service coordination

### 2. Runtime Environment

#### Node.js
- **Status**: ⚠️ **VERSION MISMATCH**
- **Current Version**: v24.1.0
- **Required Version**: Node.js 20.19.1 (as specified in Dockerfiles)
- **Compatibility**: Potential issues with newer Node.js version
- **Impact**: May cause runtime errors in local development
- **Action Required**: Consider downgrading to Node.js 20.x for compatibility

#### NPM Package Manager
- **Status**: ✅ **AVAILABLE**
- **Current Version**: Available with Node.js
- **Purpose**: Dependency management for both backend and frontend
- **Action Required**: None - properly installed

### 3. Application Dependencies

#### Backend Dependencies
- **Status**: ❌ **MISSING**
- **Location**: `/home/daytona/movie-theater/backend/node_modules`
- **Current Status**: Directory does not exist
- **Required Packages**: 
  - `@prisma/client: ^6.0.0`
  - `express: ^5.1.0`
  - `cors: 2.8.5`
  - `helmet: ^8.1.0`
  - `morgan: ^1.10.0`
  - `prisma: ^6.0.0`
  - `dotenv: ^16.4.0`
  - `multer: 2.0.2`
  - `uuid: 11.1.0`
- **Installation Command**: `npm install` (in backend directory)
- **Action Required**: Install before local development

#### Frontend Dependencies
- **Status**: ❌ **MISSING**
- **Location**: `/home/daytona/movie-theater/frontend/node_modules`
- **Current Status**: Directory does not exist
- **Required Packages**:
  - `react: 19.1.1`
  - `react-dom: 19.1.1`
  - `axios: 1.11.0`
  - `lucide-react: ^0.539.0`
  - `react-router-dom: ^6.28.0`
  - `@vitejs/plugin-react: ^5.0.0`
  - `vite: ^7.0.0`
  - `tailwindcss: ^3.4.0`
- **Installation Command**: `npm install` (in frontend directory)
- **Action Required**: Install before local development

### 4. Database Infrastructure

#### MySQL Database
- **Status**: ❌ **MISSING** (Containerized)
- **Required Version**: MySQL 8.0
- **Configuration**: Defined in `docker-compose.yml`
- **Container Name**: `movietheater-db`
- **Port Mapping**: `3307:3306`
- **Dependencies**: Requires Docker to run
- **Health Check**: Configured with 30s intervals
- **Action Required**: Install Docker to enable database container

#### Database Connection
- **Status**: ❌ **UNAVAILABLE**
- **Connection String**: `mysql://{project_slug}user:{project_slug}password@db:3306/{project_slug}`
- **Current Issue**: Database container cannot start without Docker
- **Impact**: Backend health checks will fail
- **Action Required**: Start database container via Docker Compose

### 5. Environment Configuration

#### Environment Variables File
- **Status**: ✅ **TEMPLATE AVAILABLE**
- **Template File**: `.env.example` (newly added)
- **Generated File**: `.env` (auto-generated by `run.sh`)
- **Configuration Variables**:
  ```
  MYSQL_ROOT_PASSWORD=rootpassword
  MYSQL_DATABASE={project_slug}
  MYSQL_USER={project_slug}user
  MYSQL_PASSWORD={project_slug}password
  DATABASE_URL=mysql://{project_slug}user:{project_slug}password@db:3306/{project_slug}
  PORT=4000
  CORS_ORIGIN=http://localhost:5173
  NODE_ENV=production
  ```
- **Auto-Generation**: The `run.sh` script will create `.env` from `.env.example`
- **Action Required**: None - handled automatically by deployment script

## Missing Components Summary

### Critical Missing Components (Application Cannot Start)
1. **Docker Engine** - Container runtime
2. **Docker Compose** - Multi-container orchestration
3. **MySQL Database Container** - Data persistence layer

### Important Missing Components (Local Development)
1. **Backend Dependencies** - Node.js packages for API functionality
2. **Frontend Dependencies** - React and build tool packages
3. **Generated .env File** - Environment configuration (auto-generated)

### Compatibility Issues
1. **Node.js Version Mismatch** - v24.1.0 vs required v20.19.1

## Infrastructure Architecture

### Containerized Services (Primary Deployment)
```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   Frontend      │    │    Backend      │    │    Database     │
│   (React/Vite)  │    │   (Express.js)  │    │    (MySQL 8.0)  │
│   Port: 5173    │    │   Port: 4000    │    │   Port: 3307    │
│   nginx:alpine  │    │   node:20.19.0  │    │   mysql:8.0     │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         └───────────────────────┼───────────────────────┘
                                 │
                    ┌─────────────────┐
                    │ Docker Compose  │
                    │  Orchestration  │
                    └─────────────────┘
```

### Service Dependencies
- **Frontend** → depends on → **Backend**
- **Backend** → depends on → **Database** (healthy)
- **Database** → requires → **Docker Engine**

## Port Allocations

| Service  | Internal Port | External Port | Status |
|----------|---------------|---------------|---------|
| Frontend | 80            | 5173          | ❌ Cannot start |
| Backend  | 4000          | 4000          | ❌ Cannot start |
| Database | 3306          | 3307          | ❌ Cannot start |

## Volume Mounts

| Service  | Host Path | Container Path | Purpose |
|----------|-----------|----------------|---------|
| Database | `mysql_data` | `/var/lib/mysql` | Data persistence |
| Backend  | `./backend/uploads` | `/app/uploads` | File uploads |

## Network Configuration

- **CORS Origin**: `http://localhost:5173` (Frontend → Backend)
- **API Base URL**: `http://localhost:4000/api` (Frontend API calls)
- **Database Host**: `db` (Internal Docker network)

## Health Check Configuration

### Database Health Check
- **Command**: `mysqladmin ping`
- **Interval**: 30 seconds
- **Timeout**: 10 seconds
- **Retries**: 5
- **Start Period**: 30 seconds

### Application Health Check
- **Endpoint**: `http://localhost:4000/api/health`
- **Method**: GET
- **Expected Response**: JSON with status "healthy"

## Installation Priority

### Phase 1: Critical Infrastructure (Required for any deployment)
1. Install Docker Engine
2. Install Docker Compose
3. Verify Docker installation

### Phase 2: Application Deployment (Containerized - Recommended)
1. Run `./run.sh` to start all services
2. Verify health endpoints
3. Test application functionality

### Phase 3: Local Development Setup (Alternative)
1. Install/verify Node.js 20.19.1
2. Install backend dependencies (`npm install`)
3. Install frontend dependencies (`npm install`)
4. Set up local MySQL or SQLite database
5. Configure environment variables manually

## Verification Commands

After installing required infrastructure:

```bash
# Verify Docker installation
docker --version
docker compose version

# Start application (creates .env automatically)
./run.sh

# Verify services are running
docker compose ps

# Test health endpoints
curl http://localhost:4000/api/health

# Access application
# Frontend: http://localhost:5173
# API: http://localhost:4000
```

## Conclusion

The Movie Theater application has a **well-designed infrastructure** but is currently **non-functional due to missing Docker components**. The primary blocker is the absence of Docker Engine and Docker Compose, which are essential for the containerized architecture.

Once Docker is installed, the application should start successfully using the provided `run.sh` script, which handles environment configuration and service orchestration automatically.
